{"ast":null,"code":"var _jsxFileName = \"/Applications/MAMP/htdocs/foris-react-redux/client/src/AuthContext.jsx\",\n    _s = $RefreshSig$();\n\nimport * as React from 'react';\nimport { firebaseAuth } from './util/firebase';\nimport { useLocation } from 'react-router-dom';\nimport history from './util/history';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/React.createContext();\n\nconst AuthProvider = ({\n  children\n}) => {\n  _s();\n\n  const [globalLoading, setGlobalLoading] = React.useState(true);\n  const [currentPath, setCurrentPath] = React.useState('');\n  const location = useLocation();\n  const [user, setUser] = React.useState({\n    profile: {},\n    signedIn: false\n  });\n\n  const onAuthStateChange = callback => {\n    return firebaseAuth.onAuthStateChanged(user => {\n      if (user) {\n        callback({\n          signedIn: true,\n          profile: user\n        });\n      } else {\n        callback({\n          signedIn: false\n        });\n      }\n    });\n  };\n\n  React.useEffect(() => {\n    setCurrentPath(location.pathname);\n  }, [location]);\n  React.useEffect(() => {\n    console.log('Hello from AuthContext');\n    firebaseAuth.onAuthStateChanged(result => {\n      if (result) {\n        console.log(result, '******');\n\n        if (result.uid !== user.uid) {\n          setUser(result);\n          setGlobalLoading(false);\n\n          if (currentPath.match(/(auth\\/signin|auth\\/signup)/) || currentPath === '/') {\n            history.push('/schools');\n          } else {\n            history.push(currentPath);\n          }\n        } else if (!!result) {\n          if (currentPath === '/') {\n            history.push('/schools');\n          }\n\n          setGlobalLoading(false);\n        }\n      } else {\n        if (currentPath === '/') {\n          history.push('/schools');\n        }\n\n        setGlobalLoading(false);\n      }\n    });\n  });\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      setUser,\n      globalLoading,\n      currentPath\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AuthProvider, \"v/A9sxrWj9TxAJmW4gYLXUXdaQE=\", false, function () {\n  return [useLocation];\n});\n\n_c = AuthProvider;\nconst AuthConsumer = AuthContext.Consumer;\nexport { AuthContext, AuthProvider, AuthConsumer };\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"sources":["/Applications/MAMP/htdocs/foris-react-redux/client/src/AuthContext.jsx"],"names":["React","firebaseAuth","useLocation","history","AuthContext","createContext","AuthProvider","children","globalLoading","setGlobalLoading","useState","currentPath","setCurrentPath","location","user","setUser","profile","signedIn","onAuthStateChange","callback","onAuthStateChanged","useEffect","pathname","console","log","result","uid","match","push","AuthConsumer","Consumer"],"mappings":"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","sourcesContent":["// @flow\nimport * as React from 'react'\nimport { firebaseAuth } from './util/firebase'\nimport { useLocation } from 'react-router-dom'\nimport history from './util/history'\n\nconst AuthContext: React.Context<any> = React.createContext()\n\nconst AuthProvider = ({\n  children,\n}: {\n  children: React.Element<any>,\n}): React.Element<any> => {\n  const [globalLoading, setGlobalLoading] = React.useState(true)\n  const [currentPath, setCurrentPath] = React.useState('')\n  const location = useLocation()\n  const [user, setUser] = React.useState({\n    profile: {},\n    signedIn: false,\n  })\n\n  const onAuthStateChange = callback => {\n    return firebaseAuth.onAuthStateChanged(user => {\n      if (user) {\n        callback({ signedIn: true, profile: user })\n      } else {\n        callback({ signedIn: false })\n      }\n    })\n  }\n\n  React.useEffect(() => {\n    setCurrentPath(location.pathname)\n  }, [location])\n\n  React.useEffect(() => {\n    console.log('Hello from AuthContext')\n    firebaseAuth.onAuthStateChanged(result => {\n      if (result) {\n        console.log(result, '******')\n        if (result.uid !== user.uid) {\n          setUser(result)\n          setGlobalLoading(false)\n          if (\n            currentPath.match(/(auth\\/signin|auth\\/signup)/) ||\n            currentPath === '/'\n          ) {\n            history.push('/schools')\n          } else {\n            history.push(currentPath)\n          }\n        } else if (!!result) {\n          if (currentPath === '/') {\n            history.push('/schools')\n          }\n          setGlobalLoading(false)\n        }\n      } else {\n        if (currentPath === '/') {\n          history.push('/schools')\n        }\n        setGlobalLoading(false)\n      }\n    })\n  })\n\n  return (\n    <AuthContext.Provider value={{ user, setUser, globalLoading, currentPath }}>\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\nconst AuthConsumer = AuthContext.Consumer\nexport { AuthContext, AuthProvider, AuthConsumer }\n"]},"metadata":{},"sourceType":"module"}