{"ast":null,"code":"var _jsxFileName = \"/Applications/MAMP/htdocs/foris-react-redux/client/src/AuthContext.jsx\",\n    _s = $RefreshSig$();\n\nimport * as React from 'react';\nimport { firebaseAuth } from './util/firebase';\nimport { useLocation } from 'react-router-dom';\nimport history from './util/history';\nimport { onAuthStateChange } from './hooks/useAuth';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/React.createContext();\n\nconst AuthProvider = ({\n  children\n}) => {\n  _s();\n\n  const [globalLoading, setGlobalLoading] = React.useState(false);\n  const [currentPath, setCurrentPath] = React.useState('');\n  const location = useLocation();\n  const [user, setUser] = React.useState({\n    profile: {},\n    signedIn: false\n  });\n  React.useEffect(() => {\n    setCurrentPath(location.pathname);\n  }, [location]); // React.useEffect(() => {\n  //   console.log('Hello from AuthContext')\n  //   firebaseAuth.onAuthStateChanged(result => {\n  //     if (result) {\n  //       console.log(result, '******')\n  //       if (result.uid !== user.uid) {\n  //         setUser(result)\n  //         setGlobalLoading(false)\n  //         if (\n  //           currentPath.match(/(auth\\/signin|auth\\/signup)/) ||\n  //           currentPath === '/'\n  //         ) {\n  //           history.push('/schools')\n  //         } else {\n  //           history.push(currentPath)\n  //         }\n  //       } else if (!!result) {\n  //         if (currentPath === '/') {\n  //           history.push('/schools')\n  //         }\n  //         setGlobalLoading(false)\n  //       }\n  //     } else {\n  //       if (currentPath === '/') {\n  //         history.push('/schools')\n  //       }\n  //       setGlobalLoading(false)\n  //     }\n  //   })\n  // })\n\n  React.useEffect(() => {\n    const unsubscribe = onAuthStateChange(setUser);\n    return () => {\n      unsubscribe();\n      setGlobalLoading(false);\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      setUser,\n      globalLoading,\n      setGlobalLoading,\n      currentPath\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AuthProvider, \"wIp8/wV+aBlOkit/h+9zP4iq5Zg=\", false, function () {\n  return [useLocation];\n});\n\n_c = AuthProvider;\nconst AuthConsumer = AuthContext.Consumer;\nexport { AuthContext, AuthProvider, AuthConsumer };\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"sources":["/Applications/MAMP/htdocs/foris-react-redux/client/src/AuthContext.jsx"],"names":["React","firebaseAuth","useLocation","history","onAuthStateChange","AuthContext","createContext","AuthProvider","children","globalLoading","setGlobalLoading","useState","currentPath","setCurrentPath","location","user","setUser","profile","signedIn","useEffect","pathname","unsubscribe","AuthConsumer","Consumer"],"mappings":";;;AACA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,SAASC,YAAT,QAA6B,iBAA7B;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,OAAOC,OAAP,MAAoB,gBAApB;AACA,SAASC,iBAAT,QAAkC,iBAAlC;;AAEA,MAAMC,WAA+B,gBAAGL,KAAK,CAACM,aAAN,EAAxC;;AAEA,MAAMC,YAAY,GAAG,CAAC;AACpBC,EAAAA;AADoB,CAAD,KAIK;AAAA;;AACxB,QAAM,CAACC,aAAD,EAAgBC,gBAAhB,IAAoCV,KAAK,CAACW,QAAN,CAAe,KAAf,CAA1C;AACA,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgCb,KAAK,CAACW,QAAN,CAAe,EAAf,CAAtC;AACA,QAAMG,QAAQ,GAAGZ,WAAW,EAA5B;AACA,QAAM,CAACa,IAAD,EAAOC,OAAP,IAAkBhB,KAAK,CAACW,QAAN,CAAe;AACrCM,IAAAA,OAAO,EAAE,EAD4B;AAErCC,IAAAA,QAAQ,EAAE;AAF2B,GAAf,CAAxB;AAKAlB,EAAAA,KAAK,CAACmB,SAAN,CAAgB,MAAM;AACpBN,IAAAA,cAAc,CAACC,QAAQ,CAACM,QAAV,CAAd;AACD,GAFD,EAEG,CAACN,QAAD,CAFH,EATwB,CAaxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAd,EAAAA,KAAK,CAACmB,SAAN,CAAgB,MAAM;AACpB,UAAME,WAAW,GAAGjB,iBAAiB,CAACY,OAAD,CAArC;AACA,WAAO,MAAM;AACXK,MAAAA,WAAW;AACXX,MAAAA,gBAAgB,CAAC,KAAD,CAAhB;AACD,KAHD;AAID,GAND,EAMG,EANH;AAQA,sBACE,QAAC,WAAD,CAAa,QAAb;AACE,IAAA,KAAK,EAAE;AAAEK,MAAAA,IAAF;AAAQC,MAAAA,OAAR;AAAiBP,MAAAA,aAAjB;AAAgCC,MAAAA,gBAAhC;AAAkDE,MAAAA;AAAlD,KADT;AAAA,cAEGJ;AAFH;AAAA;AAAA;AAAA;AAAA,UADF;AAMD,CA9DD;;GAAMD,Y;UAOaL,W;;;KAPbK,Y;AAgEN,MAAMe,YAAY,GAAGjB,WAAW,CAACkB,QAAjC;AACA,SAASlB,WAAT,EAAsBE,YAAtB,EAAoCe,YAApC","sourcesContent":["// @flow\nimport * as React from 'react'\nimport { firebaseAuth } from './util/firebase'\nimport { useLocation } from 'react-router-dom'\nimport history from './util/history'\nimport { onAuthStateChange } from './hooks/useAuth'\n\nconst AuthContext: React.Context<any> = React.createContext()\n\nconst AuthProvider = ({\n  children,\n}: {\n  children: React.Element<any>,\n}): React.Element<any> => {\n  const [globalLoading, setGlobalLoading] = React.useState(false)\n  const [currentPath, setCurrentPath] = React.useState('')\n  const location = useLocation()\n  const [user, setUser] = React.useState({\n    profile: {},\n    signedIn: false,\n  })\n\n  React.useEffect(() => {\n    setCurrentPath(location.pathname)\n  }, [location])\n\n  // React.useEffect(() => {\n  //   console.log('Hello from AuthContext')\n  //   firebaseAuth.onAuthStateChanged(result => {\n  //     if (result) {\n  //       console.log(result, '******')\n  //       if (result.uid !== user.uid) {\n  //         setUser(result)\n  //         setGlobalLoading(false)\n  //         if (\n  //           currentPath.match(/(auth\\/signin|auth\\/signup)/) ||\n  //           currentPath === '/'\n  //         ) {\n  //           history.push('/schools')\n  //         } else {\n  //           history.push(currentPath)\n  //         }\n  //       } else if (!!result) {\n  //         if (currentPath === '/') {\n  //           history.push('/schools')\n  //         }\n  //         setGlobalLoading(false)\n  //       }\n  //     } else {\n  //       if (currentPath === '/') {\n  //         history.push('/schools')\n  //       }\n  //       setGlobalLoading(false)\n  //     }\n  //   })\n  // })\n\n  React.useEffect(() => {\n    const unsubscribe = onAuthStateChange(setUser)\n    return () => {\n      unsubscribe()\n      setGlobalLoading(false)\n    }\n  }, [])\n\n  return (\n    <AuthContext.Provider\n      value={{ user, setUser, globalLoading, setGlobalLoading, currentPath }}>\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\nconst AuthConsumer = AuthContext.Consumer\nexport { AuthContext, AuthProvider, AuthConsumer }\n"]},"metadata":{},"sourceType":"module"}